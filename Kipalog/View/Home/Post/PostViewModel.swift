//
//  PostViewModel.swift
//  Kipalog
//
//  Created by DTVD on 2019/01/05.
//  Copyright © 2019 Kipalog. All rights reserved.
//

import UIKit
import RxSwift
import RxCocoa

class PostViewModel: DependencyInjectable {
    typealias Dependency = Post

    var post: Post
    var htmlString = "<section id=\"content\" class=\"ui pilled segment md\" ng-non-bindable=\"\">\n      <p><a class=\"fluidbox fluidbox__instance-1 fluidbox--initialized fluidbox--closed fluidbox--ready\" href=\"http://blog.ghost.org/content/images/2015/03/markdown-guide-1.jpg\"><div class=\"fluidbox__wrap\" style=\"z-index: 990;\"><img src=\"http://blog.ghost.org/content/images/2015/03/markdown-guide-1.jpg\" alt=\"Markdown Guide\" class=\"fluidbox__thumb\" style=\"opacity: 1;\"><div class=\"fluidbox__ghost\" style=\"width: 321px; height: 208px; top: 0px; left: 0px;\"></div></div></a><a></a><br>\n<em>Hình ảnh lấy từ <a href=\"http://blog.ghost.org/markdown/\">http://blog.ghost.org/markdown/</a></em></p>\n\n<p>Nếu bạn đang đọc bài này khi đã là một người dùng của Kipalog, chắc hẳn bạn sẽ không còn lạ lẫm gì với <strong>Markdown</strong>  - chuẩn viết tài liệu kỹ thuật của giới phát triển phần mềm. Dùng Markdown bạn sẽ viết được những nội dung phong phú với công sức bỏ ra là ít nhất, tiếng Nhật gọi là サクサク (saku-saku) - viết ra cứ rào rào như kiểu \"thái mấy nhát rau\" hay \"cắn vài nhát thịt\" <img class=\"emoji\" title=\":smile:\" alt=\":smile:\" src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f604.png\" height=\"20\" width=\"20\" align=\"absmiddle\"></p>\n\n<p>Vậy Markdown viết dễ như thế nào? Sử dụng Kipalog ra sao để viết Markdown cho hiệu quả? Bài viết này sẽ đưa cho bạn câu trả lời đầy đủ nhất. </p>\n\n<span id=\"toc-l-ch-s-c-a-markdown\"></span><h1 class=\"ui dividing header\">Lịch sử của Markdown</h1>\n\n<p>Năm 2004, <a href=\"https://en.wikipedia.org/wiki/John_Gruber\">John_Gruber</a> - một designer, blogger chuyên về các sản phẩm của Apple phát điên sau khi phải viết một tài liệu HTML dài dằng dặc. Anh nảy ra ý tưởng tạo ra một ngôn ngữ cho các tài liệu trên web mà phải <em>dễ viết, dễ đọc ở định dạng tự nhiên và có thể chuyển thành HTML</em>. Với sự giúp đỡ của <a href=\"https://en.wikipedia.org/wiki/Aaron_Swartz\">Aaron Swartz</a>. <a href=\"https://en.wikipedia.org/wiki/John_Gruber\">John_Gruber</a>  thực sự đã phát minh ra <strong>Markdown</strong> mà chúng ta biết ngày nay.</p>\n\n<p>Bạn hãy thử nhìn một ví dụ đơn giản nhé.</p>\n\n<pre><code class=\"md ui segment hljs \"><span class=\"hljs-strong\">**Markdown**</span> quá <span class=\"hljs-emphasis\">*tuyệt*</span> phải không nào. Cảm ơn [<span class=\"hljs-link_label\">John_Gruber</span>](<span class=\"hljs-link_url\">https://en.wikipedia.org/wiki/John_Gruber</span>).\n</code></pre>\n\n<p>Và chúng ta sẽ có :</p>\n\n<p><strong>Markdown</strong> quá <em>tuyệt</em> phải không nào. Cảm ơn <a href=\"https://en.wikipedia.org/wiki/John_Gruber\">John_Gruber</a>.</p>\n\n<p>Ban đầu mình chẳng hiểu và cũng chẳng thích Markdown lắm đâu. Lý do ư? Mình có thể viết Word (Google Docs nếu viết online), dùng Evernote hay vô số các trình soạn thảo online/offline khác. Tuy vậy sau một vài phút mình <em>bắt đầu phải đi tìm nút bôi đậm, in nghiêng, định dạng thành danh sách hay chèn link, chèn ảnh</em> v.v...  Đi tìm nút là đơn giản khi mới làm quen, nhưng vô cùng bất tiện khi viết một văn bản dài. </p>\n\n<p>Chuyện gì xảy ra tiếp theo? Ngao ngán, ngáp, bản chất \"lười và tỏ ra ngu ngốc\" trỗi dậy và bắt đầu tìm đến Markdown <img class=\"emoji\" title=\":smile:\" alt=\":smile:\" src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f604.png\" height=\"20\" width=\"20\" align=\"absmiddle\">  Flow viết trở nên nhịp nhàng hơn, tay không rời bàn phím và không phải đụng đến chuột để đi click nút nữa.</p>\n\n<span id=\"toc-ng-ph-p-c-b-n-c-a-markdown\"></span><h1 class=\"ui dividing header\">Ngữ pháp cơ bản của Markdown</h1>\n\n<p>Tất cả cú pháp của Markdown đều rất rõ ràng và trong sáng. Nếu bạn có thể nhớ 1 lần, bạn sẽ nhớ được mãi mãi. <br>\nHãy coi bài viết này như một tài liệu tra cứu mỗi khi không nhớ ra các cú pháp của Markdown nhé!</p>\n\n<span id=\"toc-ti-u-\"></span><h2 class=\"ui dividing header\">Tiêu đề</h2>\n\n<p>Các lớp tiêu đề h1,h2,h3 cho đến h6 có thể viết được bằng cách thêm số lượng ký tự <code>#</code> tương ứng vào đầu dòng. Một ký tự <code>#</code> tương đương với h1, 2 ký tự <code>#</code> tương đương với h2 ... Tuy vậy để viết một bài viết dễ đọc thì hiếm khi cần dùng đến quá 3 ký tự này.</p>\n\n<pre><code class=\"md ui segment hljs \"><span class=\"hljs-header\"># Header h1</span>\n<span class=\"hljs-header\">## Header h2</span>\n<span class=\"hljs-header\">### Header h3</span>\n</code></pre>\n\n<span id=\"toc-b-i-m-v-in-nghi-ng\"></span><h2 class=\"ui dividing header\">Bôi đậm và in nghiêng</h2>\n\n<p>Kẹp một từ ở đầu và cuối bằng 1 ký tự <code>*</code> để <em>in nghiêng</em>, 2 ký tự <code>**</code> để <strong>bôi đậm</strong>, và 3 ký tự <code>***</code> để <strong><em>vừa in nghiêng vừa bôi đậm</em></strong>.<br>\nNếu muốn bạn có thể dùng gạch dưới <code>_</code> thay cho dấu sao <code>*</code>.</p>\n\n<pre><code class=\"md ui segment hljs \"><span class=\"hljs-strong\">**Bold**</span> and <span class=\"hljs-emphasis\">*italic*</span> and <span class=\"hljs-strong\">***both**</span>*.\n<span class=\"hljs-strong\">__Bold__</span> and <span class=\"hljs-emphasis\">_talic_</span> and <span class=\"hljs-strong\">___both__</span>_\n</code></pre>\n\n<p>Ngoài ra chữ có thể <del>gạch ngang</del> bằng 2 dấu <code>~~</code>.</p>\n\n<pre><code class=\"md ui segment hljs \">~~strike me~~\n</code></pre>\n\n<span id=\"toc-link\"></span><h2 class=\"ui dividing header\">Link</h2>\n\n<p>Viết link trong markdown bằng cách cho alt text vào trong ngoặc vuông<code>[]</code> và link thật vào trong ngoặc đơn <code>()</code>. Ví dụ ở đây giống hệt ví dụ đầu tiên về <a href=\"https://en.wikipedia.org/wiki/John_Gruber\">John_Gruber</a> ở đoạn trên.</p>\n\n<pre><code class=\"md ui segment hljs \">[<span class=\"hljs-link_label\">John_Gruber</span>](<span class=\"hljs-link_url\">https://en.wikipedia.org/wiki/John_Gruber</span>)\n</code></pre>\n\n<p>Ngoài ra bạn có thể thêm tiêu đề cho  link bằng cách thêm <code>\"title\"</code> trong mô tả bên trong ngoặc đơn <code>()</code>.</p>\n\n<pre><code class=\"md ui segment hljs \">[<span class=\"hljs-link_label\">John_Gruber</span>](<span class=\"hljs-link_url\">https://en.wikipedia.org/wiki/John_Gruber \"Markdown Creator\"</span>)\n</code></pre>\n\n<span id=\"toc-h-nh-nh\"></span><h2 class=\"ui dividing header\">Hình ảnh</h2>\n\n<p>Chèn hình ảnh trong markdown chỉ khác với chèn link đôi chút. Bạn thêm ký tự <code>!</code> vào đầu tiên, sau đó ghi alt text và link ảnh vào trong ngoặc vuông <code>[]</code> và ngoặc đơn <code>()</code>.</p>\n\n<pre><code class=\"md ui segment hljs \">![<span class=\"hljs-link_label\">Atom</span>](<span class=\"hljs-link_url\">https://atom.io/assets/packages-d16d6cc46fd0cf01842409577e782b74.gif</span>)\n</code></pre>\n\n<p>Trên <strong>Kipalog</strong> thì đơn giản hơn, bạn có thể kéo, thả hoặc là copy và paste ảnh trực tiếp vào editor để bắt đầu upload <img class=\"emoji\" title=\":smile:\" alt=\":smile:\" src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f604.png\" height=\"20\" width=\"20\" align=\"absmiddle\"></p>\n\n<p><a class=\"fluidbox fluidbox__instance-2 fluidbox--initialized fluidbox--closed fluidbox--ready\" href=\"https://github-atom-io-herokuapp-com.global.ssl.fastly.net/assets/packages-0fc07ecae73a786761ada738d16ae2ff.gif\"><div class=\"fluidbox__wrap\" style=\"z-index: 990;\"><img src=\"https://github-atom-io-herokuapp-com.global.ssl.fastly.net/assets/packages-0fc07ecae73a786761ada738d16ae2ff.gif\" alt=\"Atom\" class=\"fluidbox__thumb\" style=\"opacity: 1;\"><div class=\"fluidbox__ghost\" style=\"width: 321px; height: 368px; top: 0px; left: 0px;\"></div></div></a><a></a></p>\n\n<span id=\"toc--nh-d-ng-danh-s-ch\"></span><h2 class=\"ui dividing header\">Định dạng danh sách</h2>\n\n<p>Để định đạng một đoạn văn bản thành các gạch đầu dòng trong markdown, bạn dùng ký tự <code>*</code> và một dấu cách ở mỗi ý và dùng thêm 2 dấu cách ở đằng trước nếu muốn lùi vào một level.</p>\n\n<pre><code class=\"md ui segment hljs \"><span class=\"hljs-bullet\">* </span>Ruby\n<span class=\"hljs-bullet\">* </span>PHP\n  * Laravel\n  * Symfony\n  * Phalcon\n<span class=\"hljs-bullet\">* </span>Python\n  * Flask\n<span class=\"hljs-code\">     * Jinja2</span>\n<span class=\"hljs-code\">     * WSGI1.0 </span>\n  * Django \n</code></pre>\n\n<p>sẽ trở thành:</p>\n\n<ul class=\"ui list\">\n<li>Ruby</li>\n<li>PHP\n\n<ul class=\"ui list\">\n<li>Laravel</li>\n<li>Symfony</li>\n<li>Phalcon</li>\n</ul>\n</li>\n<li>Python\n\n<ul class=\"ui list\">\n<li>Flask\n\n<ul class=\"ui list\">\n<li>Jinja2</li>\n<li>WSGI1.0 </li>\n</ul>\n</li>\n<li>Django </li>\n</ul>\n</li>\n</ul>\n\n<p>Nếu bạn muốn dùng số để đánh dấu thì viết số và một dấu chấm <code>.</code></p>\n\n<pre><code class=\"md ui segment hljs \"><span class=\"hljs-bullet\">1. </span>number one\n<span class=\"hljs-bullet\">2. </span>number two\n<span class=\"hljs-bullet\">3. </span>number three\n</code></pre>\n\n<p>sẽ trở thành:</p>\n\n<ol>\n<li>number one</li>\n<li>number two</li>\n<li>number three</li>\n</ol>\n\n<span id=\"toc-tr-ch-d-n\"></span><h2 class=\"ui dividing header\">Trích dẫn</h2>\n\n<p>Cách viết một trích dẫn giống hệt khi bạn vẫn trả lời bình luận hay dẫn chứng trong các diễn đàn: sử dụng ký tự <code>&gt;</code>.</p>\n\n<pre><code class=\"md ui segment hljs \"><span class=\"hljs-blockquote\">&gt; Programming today is a race between software engineers striving to build bigger and better idiot-proof programs, and the Universe trying to produce bigger and better idiots. So far, the Universe is winning. </span>\n</code></pre>\n\n<blockquote>\n<p>Programming today is a race between software engineers striving to build bigger and better idiot-proof programs, and the Universe trying to produce bigger and better idiots. So far, the Universe is winning. </p>\n</blockquote>\n\n<span id=\"toc-ng-ph-p-n-ng-cao-c-a-markdown\"></span><h1 class=\"ui dividing header\">Ngữ pháp nâng cao của Markdown</h1>\n\n<p>Kể từ đây sẽ là các cú pháp thuộc phần nâng cao. Một số trong số này không được hỗ trợ trực tiếp bởi Markdown, nhưng được hỗ trợ bởi Kipalog <img class=\"emoji\" title=\":smile:\" alt=\":smile:\" src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f604.png\" height=\"20\" width=\"20\" align=\"absmiddle\"></p>\n\n<span id=\"toc-m-code\"></span><h2 class=\"ui dividing header\">Mã code</h2>\n\n<p>Có 2 loại code có thể viết trong markdown: inline code (code trong dòng) và code block (đoạn code riêng).  Inline code dùng <em>ký tự phẩy ngược</em></p>\n\n<pre><code class=\"md ui segment hljs \">The <span class=\"hljs-code\">`let`</span> keyword.\n</code></pre>\n\n<p>... còn code block dùng <em>3 ký tự phẩy ngược kẹp ở đầu và đuôi của 1 đoạn</em>. Khi bạn muốn cú pháp <em>hiển thị chính xác với ngôn ngữ</em> của đoạn code thì có thể thêm định danh ngôn ngữ ở <em>3 ký tự phẩy ngược mở đoạn</em>  như dưới đây.</p>\n\n<pre><code class=\"ui segment hljs coffeescript\">`<span class=\"javascript\"></span>``<span class=\"javascript\">python\nimport os\nos.system(<span class=\"hljs-string\">'clear'</span>)\n</span>``<span class=\"javascript\"></span>`</code></pre>\n\n<p>Ngoài ra nếu cách đầu dòng 4 dấu cách cho 1 đoạn thì đoạn đó cũng sẽ được tự động nhận là một code block.</p>\n\n<pre><code class=\"md ui segment hljs \"><span class=\"hljs-code\">    import os</span>\n<span class=\"hljs-code\">    os.system('clear')</span>\n</code></pre>\n\n<span id=\"toc-b-ng\"></span><h2 class=\"ui dividing header\">Bảng</h2>\n\n<p>Vẽ bảng trong Markdown sẽ hơi khó nếu bạn chưa quen. Các cột được tách nhau bằng dấu ngăn thẳng đứng <code>|</code> và header được tách với content bằng dấu gạch ngang <code>-</code>.</p>\n\n<pre><code class=\"ui segment hljs ruby\">| <span class=\"hljs-constant\">Tables</span>        | <span class=\"hljs-constant\">Are</span>           | <span class=\"hljs-constant\">Cool</span>  |\n| ------------- |<span class=\"hljs-symbol\">:-------------</span><span class=\"hljs-symbol\">:|</span> -----<span class=\"hljs-symbol\">:|</span>\n| col <span class=\"hljs-number\">3</span> is      | right-aligned | <span class=\"hljs-variable\">$1600</span> |\n| col <span class=\"hljs-number\">2</span> is      | centered      |   <span class=\"hljs-variable\">$12</span> |\n| zebra stripes | are neat      |    <span class=\"hljs-variable\">$1</span> |\n</code></pre>\n\n<p>Ở dòng ngăn cách giữa header và content bạn sẽ thấy ký hiệu căn lề trái phải (cột 2 và cột 3) bằng dấu <code>:</code>. Bảng trên sẽ được render thành cấu trúc HTML như dưới đây.</p>\n\n<table class=\"ui collapsing table\">\n<thead>\n<tr>\n<th>Tables</th>\n<th>Are</th>\n<th>Cool</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>col 3 is</td>\n<td style=\"text-align: center\">right-aligned</td>\n<td style=\"text-align: right\">$1600</td>\n</tr>\n<tr>\n<td>col 2 is</td>\n<td style=\"text-align: center\">centered</td>\n<td style=\"text-align: right\">$12</td>\n</tr>\n<tr>\n<td>zebra stripes</td>\n<td style=\"text-align: center\">are neat</td>\n<td style=\"text-align: right\">$1</td>\n</tr>\n</tbody>\n</table>\n\n<span id=\"toc-link-t-i-li-u-tham-kh-o\"></span><h2 class=\"ui dividing header\">Link  tài liệu tham khảo</h2>\n\n<p>Markdown được thiết kế để dễ nhìn ngay ở định dạng tự nhiên. Vì vậy bạn có thể đánh dấu mỗi link thành từng số và viết tất cả link thực tương ứng với các số ở cuối cùng.</p>\n\n<pre><code class=\"ui segment hljs markdown\">Let's check out [<span class=\"hljs-link_label\">Wikipedia</span>][<span class=\"hljs-link_reference\">1</span>] and [<span class=\"hljs-link_label\">Google</span>][<span class=\"hljs-link_reference\">2</span>].\n...\n...\n[<span class=\"hljs-link_reference\">1</span>]:<span class=\"hljs-link_url\"> https://en.wikipedia.org \"Wikipedia\"</span><br><span class=\"hljs-link_url\">[2]: https://www.google.com \"Google\"</span></code></pre>\n\n<span id=\"toc-link-nhanh\"></span><h2 class=\"ui dividing header\">Link nhanh</h2>\n\n<p>Bạn thậm chí có thể viết link trực tiếp như là WYSIWYG: <a href=\"http://kipalog.com\">http://kipalog.com</a> .</p>\n\n<span id=\"toc-ch-th-ch\"></span><h2 class=\"ui dividing header\">Chú thích</h2>\n\n<p>Chú thích hay footnote sẽ dùng ký tự <code>^</code> bên trong ngoặc vuông <code>[]</code> để đánh dấu và viết lại giải thích ở cuối, cách viết tương tự như link tài liệu tham khảo bên trên.</p>\n\n<pre><code class=\"ui segment hljs css\"><span class=\"hljs-tag\">John</span> <span class=\"hljs-tag\">Gruber</span><span class=\"hljs-attr_selector\">[^1]</span>.<br>...<br>...<br><span class=\"hljs-attr_selector\">[^1]</span>: <span class=\"hljs-tag\">writer</span>, <span class=\"hljs-tag\">blog</span> <span class=\"hljs-tag\">publisher</span>, <span class=\"hljs-tag\">UI</span> <span class=\"hljs-tag\">designer</span>, <span class=\"hljs-tag\">the</span> <span class=\"hljs-tag\">inventor</span> <span class=\"hljs-tag\">of</span> <span class=\"hljs-tag\">the</span> <span class=\"hljs-tag\">Markdown</span> <span class=\"hljs-tag\">publishing</span> <span class=\"hljs-tag\">format</span>. </code></pre>\n\n<span id=\"toc-escape\"></span><h2 class=\"ui dividing header\">Escape</h2>\n\n<p>Sẽ có những lúc bạn cần dùng đến đúng những ký tự mà Markdown đang sử dụng, ví dụ đơn giản như khi muốn viết *bold* mà không bị in đậm. Khi đó hãy sử dụng ký tự escape <code>\\</code></p>\n\n<pre><code class=\"md ui segment hljs \">\\<span class=\"hljs-emphasis\">*bold\\*</span>\n</code></pre>\n\n<span id=\"toc-emoji-\"></span><h2 class=\"ui dividing header\">Emoji <img class=\"emoji\" title=\":smile:\" alt=\":smile:\" src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f604.png\" height=\"20\" width=\"20\" align=\"absmiddle\">\n</h2>\n\n<p>Emoji là các biểu tượng thể hiện cảm xúc bắt nguồn từ bộ gõ của Mac/Iphone/Ipad. Kipalog cho phép bạn viết đủ bộ emoji theo <a href=\"http://www.emoji-cheat-sheet.com/\">cheatsheet của Github</a> <img class=\"emoji\" title=\":smile:\" alt=\":smile:\" src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f604.png\" height=\"20\" width=\"20\" align=\"absmiddle\"></p>\n\n<pre><code class=\"md ui segment hljs \">:smile:\n</code></pre>\n\n<span id=\"toc-ph-m-t-t-tr-n-kipalog\"></span><h1 class=\"ui dividing header\">Phím tắt trên Kipalog</h1>\n\n<p>Kipalog cung cấp một số phím tắt giúp cho viết Markdown nhanh và thuận tiện hơn. Các bạn hãy tham khảo bảng trợ giúp <strong>Ngữ pháp Markdown</strong> nhé!</p>\n\n<p><a class=\"fluidbox fluidbox__instance-3 fluidbox--initialized fluidbox--closed fluidbox--ready\" href=\"https://i.gyazo.com/4d5c39f78e32abda99216b64554a84b7.png\"><div class=\"fluidbox__wrap\" style=\"z-index: 990;\"><img src=\"https://i.gyazo.com/4d5c39f78e32abda99216b64554a84b7.png\" alt=\"help\" class=\"fluidbox__thumb\" style=\"opacity: 1;\"><div class=\"fluidbox__ghost\" style=\"width: 321px; height: 235px; top: 0px; left: 0px;\"></div></div></a><a></a></p>\n\n<p>Hãy bắt đầu bằng những bước đơn giản: <strong>Ctrl/⌘ + B</strong> cho in đậm, <strong>Ctrl/⌘ + I</strong> cho in nghiêng và <strong>Ctrl/⌘ + K</strong> cho link nhé!</p>\n\n<span id=\"toc-k-t-lu-n\"></span><h1 class=\"ui dividing header\">Kết luận</h1>\n\n<p>Markdown quả thật rất tuyệt <em>đối với giới lập trình và phát triển phần mềm</em>. Hi vọng bài viết này có thể trở thành một bản ghi nhớ hữu ích cho bạn, và hi vọng bạn sẽ không bao giờ phải bỏ tay ra khỏi bàn phím để sờ đến chuột khi viết bài nữa <img class=\"emoji\" title=\":sunglasses:\" alt=\":sunglasses:\" src=\"https://assets-cdn.github.com/images/icons/emoji/unicode/1f60e.png\" height=\"20\" width=\"20\" align=\"absmiddle\"> </p>\n\n<p>Happy writing with Kipalog </p>\n\n    </section>"

    lazy var content: NSAttributedString? = {
        return PostViewModel.convert(from: htmlString)
    }()
    lazy var linkTextAttributes: [NSAttributedString.Key : Any] = {
        return [
            NSAttributedString.Key.foregroundColor: UIColor.kipalog.tearColor,
            NSAttributedString.Key.underlineColor: UIColor.kipalog.tearColor,
            NSAttributedString.Key.underlineStyle: NSUnderlineStyle.single.rawValue
        ]
    }()

    required init(dependency: Post) {
        self.post = dependency
    }

    func inject(dependency: Post) {
        self.post = dependency
    }
}

extension PostViewModel {
    static func convert(from string: String) -> NSAttributedString? {
        let htmlData = NSString(string: string).data(using: String.Encoding.unicode.rawValue)
        let options = [
            NSAttributedString.DocumentReadingOptionKey.documentType:
            NSAttributedString.DocumentType.html
        ]
        guard let origin = try? NSMutableAttributedString(data: htmlData ?? Data(),
            options: options,
            documentAttributes: nil)
        else { return nil}

        let attributes: [NSAttributedString.Key: Any] = [
            NSAttributedString.Key.font: UIFont.systemFont(ofSize: 16),
            NSAttributedString.Key.foregroundColor: UIColor.kipalog.textColor,
        ]
        origin.addAttributes(attributes, range: NSRange(location: 0, length: origin.length))
        return origin
    }
}
